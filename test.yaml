project_id: "fluent-drummer-468119-c3"
region: "europe-central2"
env: alpha

terraform:
  required_version: ">= 1.14.0, < 2.0.0"
  providers:
    google: "~> 7.16.0"

network:
  source: "github.com/skibinstein/modules//network?ref=1.5.0"
  depends_on: []
  items:
    - name: "main-vpc"
      auto_create_subnetworks: false
      routing_mode: "REGIONAL"
      description: "Primary VPC for application stack"
      subnets:
        - name: "public-subnet"
          ip_cidr_range: "10.0.1.0/24"
          enable_private_access: true
          flow_logs_config:
            flow_sampling: 0.5
            aggregation_interval: "INTERVAL_5_SEC"
            metadata: "INCLUDE_ALL_METADATA"
        - name: "private-subnet"
          ip_cidr_range: "10.0.2.0/24"
          enable_private_access: true
          flow_logs_config: 
            flow_sampling: 0.5
            aggregation_interval: "INTERVAL_5_SEC"
            metadata: "INCLUDE_ALL_METADATA"

gcs:
  source: "github.com/skibinstein/modules//gcs?ref=1.1.0"
  depends_on:
    - network
  items:
    - name: "my-app-assets-001"
      location: "eu-west2"
      storage_class: "STANDARD"
      versioning: true
      iam:
        "roles/storage.objectViewer":
          - "group:dev-team@example.com"
          - "serviceAccount:app-engine-sa@your-project.iam.gserviceaccount.com"
          - "serviceAccount:app-engine-sa@external-project.iam.gserviceaccount.com"
      lifecycle_rules:
        - action:
            type: "SetStorageClass"
            storage_class: "NEARLINE"
          condition:
            age: 30
        - action:
            type: "Delete"
          condition:
            age: 365
    - name: "my-app-assets-002"
    - name: "my-app-assets-003"